/*! gifscratcher.js v0.2  (c) 2014 Linus Lundahl | MIT license */
!function(t){"use strict";var e=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),i=function(t,e){this.init(t,e)};i.prototype={init:function(e,i){var s=this;return s.settings=t.extend({sprite:"",frames:0,interaction:"hover",cursor:!0,speed:5},i),s.$el=t(e),s.$image=s.$el.find("img"),s.elSize={w:0,h:0},s.elPos=s.$el.offset(),s.oldFrame=0,s.iAuto=0,s.touchIsActive=!1,s.isHovering=!1,s.stopOnHover=!1,s.cursorInteraction=!0,s.$image.on("load",function(){s.elSize={w:s.$el.width(),h:s.$el.height()}}),s.settings.sprite&&(s.$el.addClass("gifscratcher"),s.$image.addClass("gs-img"),s.preload(function(){if(s.resize(),t(window).resize(),"auto"===s.settings.interaction&&(s.settings.cursor=!1),s.addCursor(),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&"auto"!==s.settings.interaction)s.cursorInteraction=!1,s.$el.addClass("gs-touch"),s.touchInteraction(),s.touch();else{switch(s.settings.interaction){case"hover":s.$el.addClass("gs-hover"),s.hoverInteraction();break;case"drag":s.$el.addClass("gs-drag"),s.dragInteraction();break;case"auto":s.$el.addClass("gs-auto"),s.auto();break;case"autoWithHover":s.stopOnHover=!0,s.$el.addClass("gs-auto-hover"),s.auto().hoverInteraction();break;case"autoWithDrag":s.stopOnHover=!0,s.$el.addClass("gs-auto-drag"),s.auto().dragInteraction()}s.hover()}})),this},addCursor:function(){var e=this;return e.settings.cursor&&(e.$el.addClass("has-gs-cursor"),e.$cursor=t("<div></div>").addClass("gs-cursor").appendTo(e.$el)),this},preload:function(e){var i=this,s=new Image;return s.src=i.settings.sprite,s.onload=function(){i.$image.attr({src:i.settings.sprite}),t.isFunction(e)&&e()},this},touchInteraction:function(){var e=this;return e.$el.on("touchstart touchend",function(t){e.touchIsActive="touchstart"===t.type?!0:!1}),t(window).on("touchmove",function(t){var i=t.originalEvent;e.touchIsActive&&(i.preventDefault(),e.play(i.targetTouches[0].pageX-e.elPos.left))}),this},hoverInteraction:function(){var t=this;return t.$el.on("mousemove",function(e){t.play(e.pageX-t.elPos.left)}),this},dragInteraction:function(){var t=this,e=!1;return document.ondragstart=function(){return!1},t.$cursor.on("mousedown mouseup",function(t){t.preventDefault(),e=e||"mousedown"!==t.type?!1:!0}),t.$el.on("mousemove",function(i){i.preventDefault(),e&&t.play(i.clientX-t.elPos.left)}),this},auto:function(){var t,i=this,s=0;return t=function(){e(t),i.stopOnHover&&!i.isHovering&&s===i.settings.speed&&(i.switchFrame(i.iAuto),i.iAuto=i.iAuto>=i.settings.frames-1?0:i.iAuto+1),s=s===i.settings.speed?0:s+1},t(),this},hover:function(){var e=this;return t("body").on("mousemove",function(t){t.pageX>=e.elPos.left&&t.pageX<=e.elPos.left+e.elSize.w&&t.pageY>=e.elPos.top&&t.pageY<=e.elPos.top+e.elSize.h?(e.$cursor&&e.cursorInteraction&&e.$cursor.css({left:t.pageX-e.elPos.left,top:t.pageY-e.elPos.top}),e.isHovering||(e.$el.addClass("active"),e.isHovering=!0)):(e.$cursor&&e.$cursor.removeAttr("style"),e.isHovering&&(e.$el.removeClass("active"),e.isHovering=!1,e.iAuto=e.oldFrame))}),this},touch:function(){var t=this;return t.$el.on("touchstart touchend",function(){t.$el.toggleClass("active")}),this},resize:function(){var e=this;return t(window).on("resize",function(){e.$image.is(":visible")&&(e.elSize={w:e.$el.width(),h:e.$el.height()},e.elPos=e.$el.offset(),e.play(0),e.$image.css({width:e.settings.frames*e.elSize.w+"px"}))}),this},play:function(t){var e=this;return e.switchFrame(Math.floor(t/(Math.round(e.elSize.w/e.settings.frames*100)/100))),this},switchFrame:function(t){var e=this;return t!==e.oldFrame&&t<e.settings.frames&&e.$image.css({"margin-left":"-"+t*e.elSize.w+"px"}),e.oldFrame=t,this}},t.fn.gifscratcher=function(e){var s;return(s=this.data("gifscratcher"))?e===!0?s:("string"===t.type(e)&&s[e](),this):this.each(function(){return t(this).data("gifscratcher",new i(this,e))})}}(jQuery);