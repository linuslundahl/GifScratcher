!function(e){"use strict";for(var t=0,i=["ms","moz","webkit","o"],n=0;n<i.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[i[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[n]+"CancelAnimationFrame"]||window[i[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var i=(new Date).getTime(),n=Math.max(0,16-(i-t)),o=window.setTimeout(function(){e(i+n)},n);return t=i+n,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)});var o=function(e,t){this.init(e,t)};o.prototype={init:function(t,i){var n=this;return n.settings=e.extend({sprite:"",frames:0,interaction:"hover",cursor:!0,speed:5},i),n.$el=e(t),n.$image=n.$el.find("img"),n.elSize={w:0,h:0},n.elPos=n.$el.offset(),n.oldFrame=0,n.iAuto=0,n.touchIsActive=!1,n.isHovering=!1,n.stopOnHover=!1,n.cursorInteraction=!0,n.$image.on("load",function(){n.elSize={w:n.$el.width(),h:n.$el.height()}}),n.settings.sprite&&(n.$el.addClass("gifscratcher"),n.$image.addClass("gs-img"),n.preload(function(){if(n.resize(),e(window).resize(),"auto"===n.settings.interaction&&(n.settings.cursor=!1),n.addCursor(),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&"auto"!==n.settings.interaction)n.cursorInteraction=!1,n.$el.addClass("gs-touch"),n.touchInteraction(),n.touch();else{switch(n.settings.interaction){case"hover":n.$el.addClass("gs-hover"),n.hoverInteraction();break;case"drag":n.$el.addClass("gs-drag"),n.dragInteraction();break;case"auto":n.$el.addClass("gs-auto"),n.auto();break;case"autoWithHover":n.stopOnHover=!0,n.$el.addClass("gs-auto-hover"),n.auto().hoverInteraction();break;case"autoWithDrag":n.stopOnHover=!0,n.$el.addClass("gs-auto-drag"),n.auto().dragInteraction()}n.hover()}})),this},addCursor:function(){var t=this;return t.settings.cursor&&(t.$el.addClass("has-gs-cursor"),t.$cursor=e("<div></div>").addClass("gs-cursor").appendTo(t.$el)),this},preload:function(t){var i=this,n=new Image;return n.src=i.settings.sprite,n.onload=function(){i.$image.attr({src:i.settings.sprite}),e.isFunction(t)&&t()},this},touchInteraction:function(){var t=this;return t.$el.on("touchstart touchend",function(e){t.touchIsActive="touchstart"===e.type?!0:!1}),e(window).on("touchmove",function(e){var i=e.originalEvent;t.touchIsActive&&(i.preventDefault(),t.play(i.pageX-t.elPos.left))}),this},hoverInteraction:function(){var e=this;return e.$el.on("mousemove",function(t){e.play(t.pageX-e.elPos.left)}),this},dragInteraction:function(){var e=this,t=!1;return document.ondragstart=function(){return!1},e.$cursor.on("mousedown mouseup",function(e){e.preventDefault(),t=t||"mousedown"!==e.type?!1:!0}),e.$el.on("mousemove",function(i){i.preventDefault(),t&&e.play(i.clientX-e.elPos.left)}),this},auto:function(){var e,t=this,i=0;return e=function(){requestAnimationFrame(e),t.stopOnHover&&!t.isHovering&&i===t.settings.speed&&(t.switchFrame(t.iAuto),t.iAuto=t.iAuto>=t.settings.frames-1?0:t.iAuto+1),i=i===t.settings.speed?0:i+1},e(),this},hover:function(){var t=this;return e("body").on("mousemove",function(e){e.pageX>=t.elPos.left&&e.pageX<=t.elPos.left+t.elSize.w&&e.pageY>=t.elPos.top&&e.pageY<=t.elPos.top+t.elSize.h?(t.$cursor&&t.cursorInteraction&&t.$cursor.css({left:e.pageX-t.elPos.left,top:e.pageY-t.elPos.top}),t.isHovering||(t.$el.addClass("active"),t.isHovering=!0)):(t.$cursor&&t.$cursor.removeAttr("style"),t.isHovering&&(t.$el.removeClass("active"),t.isHovering=!1,t.iAuto=t.oldFrame))}),this},touch:function(){var e=this;return e.$el.on("touchstart touchend",function(){e.$el.toggleClass("active")}),this},resize:function(){var t=this;return e(window).on("resize",function(){t.elSize={w:t.$el.width(),h:t.$el.height()},t.elPos=t.$el.offset(),t.play(0),t.$image.css({width:t.settings.frames*t.elSize.w+"px"})}),this},play:function(e){var t=this;return t.switchFrame(Math.floor(e/(Math.round(t.elSize.w/t.settings.frames*100)/100))),this},switchFrame:function(e){var t=this;return e!==t.oldFrame&&e<t.settings.frames&&t.$image.css({"margin-left":"-"+e*t.elSize.w+"px"}),t.oldFrame=e,this}},e.fn.gifscratcher=function(t){var i;return(i=this.data("gifscratcher"))?t===!0?i:("string"===e.type(t)&&i[t](),this):this.each(function(){return e(this).data("gifscratcher",new o(this,t))})}}(jQuery);